function _defineProperty(n,e,t){return e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _slicedToArray(n,e){return _arrayWithHoles(n)||_iterableToArrayLimit(n,e)||_nonIterableRest()}function _toConsumableArray(n){return _arrayWithoutHoles(n)||_iterableToArray(n)||_nonIterableSpread()}function _arrayWithoutHoles(n){if(Array.isArray(n)){for(var e=0,t=new Array(n.length);e<n.length;e++)t[e]=n[e];return t}}function _arrayWithHoles(n){if(Array.isArray(n))return n}function _iterableToArray(n){if(Symbol.iterator in Object(n)||"[object Arguments]"===Object.prototype.toString.call(n))return Array.from(n)}function _iterableToArrayLimit(n,e){var t=[],r=!0,i=!1,o=void 0;try{for(var a,c=n[Symbol.iterator]();!(r=(a=c.next()).done)&&(t.push(a.value),!e||t.length!==e);r=!0);}catch(n){i=!0,o=n}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return t}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function __vue_normalize__(n,e,t,r,i,o,a,c){const u=("function"==typeof t?t.options:t)||{};u.__file="/Users/liu/githome/vue-mermaid/src/vue-mermaid.vue",u.render||(u.render=n.render,u.staticRenderFns=n.staticRenderFns,u._compiled=!0,i&&(u.functional=!0)),u._scopeId=r;{let n;if(e&&(n=function(n){e.call(this,a(n))}),void 0!==n)if(u.functional){const e=u.render;u.render=function(t,r){return n.call(r),e(t,r)}}else{const e=u.beforeCreate;u.beforeCreate=e?[].concat(e,n):[n]}}return u}function __vue_create_injector__(){const n=document.head||document.getElementsByTagName("head")[0],e=__vue_create_injector__.styles||(__vue_create_injector__.styles={}),t="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(r,i){if(!document.querySelector('style[data-vue-ssr-id~="'+r+'"]')){const o=t?i.media||"default":r,a=e[o]||(e[o]={ids:[],parts:[],element:void 0});if(!a.ids.includes(r)){let e=i.source,c=a.ids.length;if(a.ids.push(r),t&&(a.element=a.element||document.querySelector("style[data-group="+o+"]")),!a.element){const e=a.element=document.createElement("style");e.type="text/css",i.media&&e.setAttribute("media",i.media),t&&(e.setAttribute("data-group",o),e.setAttribute("data-next-index","0")),n.appendChild(e)}if(t&&(c=parseInt(a.element.getAttribute("data-next-index")),a.element.setAttribute("data-next-index",c+1)),a.element.styleSheet)a.parts.push(e),a.element.styleSheet.cssText=a.parts.filter(Boolean).join("\n");else{const n=document.createTextNode(e),t=a.element.childNodes;t[c]&&a.element.removeChild(t[c]),t.length?a.element.insertBefore(n,t[c]):a.element.appendChild(n)}}}}}function install(n){n.component("vue-mermaid",VueMermaid)}import mermaid from"mermaid";var script={name:"VueMermaid",props:{type:{type:String,default:"graph TD"},nodes:{type:Array,required:!0},styles:{type:Array,default:function(){return[]}},config:{type:Object,default:function(){return{}}},defaultConfig:{type:Object,default:function(){return{theme:"default",startOnLoad:!1,securityLevel:"loose"}}},stopOnError:{type:Boolean,default:!1}},data:function(){return{edges:[{type:"default",open:"[",close:"]"},{type:"round",open:"(",close:")"},{type:"circle",open:"((",close:"))"},{type:"asymetric",open:">",close:"]"},{type:"rhombus",open:"{",close:"}"}]}},mounted:function(){this.init(),this.loadNodes()},computed:{nodeObject:function(){var n=this.nodes;if(Array.isArray(n)&&n.length>0){return function(n,e){return Object.assign.apply(Object,[{}].concat(_toConsumableArray(n.map(function(n){return _defineProperty({},n[e],n)}))))}(n,"id")}return{}},customStyle:function(){var n=this.nodes,e=this.styles,t=n.filter(function(n){return n.style}).map(function(n){return"style ".concat(n.id," ").concat(n.style)}),r=n.filter(function(n){return n.linkStyle}).map(function(e){return"linkStyle ".concat(e.linkNumber||n.indexOf(e)," ").concat(e.linkStyle)});return t.concat(e).concat(r)},parseCode:function(){var n=this.nodes;if(Array.isArray(n)&&n.length>0){var e=this.type+"\n",t=e+this.getGroupNodes(n)+this.customStyle.join(" \n");return this.load(t),console.log(t),t}return""}},methods:{getGroupNodes:function(n){var e=this,t=new Map;return n.forEach(function(n){var e=n.group||"",r=t.get(e)||{nids:new Set,narr:[]};r.nids.add(n.id),r.narr.push(n),t.set(e,r)}),_toConsumableArray(t.entries()).map(function(n){var t=_slicedToArray(n,2),r=t[0],i=t[1],o=i.nids,a=i.narr;if(""!==r){var c=[],u=[];a.forEach(function(n){n.next?(c.push({id:n.id,text:n.text,style:n.style,editable:n.editable}),n.next.forEach(function(e){o.has(e)?c.push({id:n.id,text:n.text,link:n.link,next:[e]}):u.push({id:n.id,text:n.text,link:n.link,next:[e]})})):c.push(n)});var d=e.buildNodesStr(c),s=e.buildNodesStr(u);return"subgraph ".concat(r," \n ").concat(d," end \n ").concat(s)}return e.buildNodesStr(a)}).join(" \n")},buildNodesStr:function(n){var e=this;return n.map(function(n){return n.next&&n.next.length>0?n.next.map(function(t,r){var i=e.nodeObject[t]||e.nodeObject[t.id];return null!=i&&void 0!==i?"".concat(e.buildNode(n)).concat(e.buildLink(n,r)).concat(e.buildNode(i)):"".concat(e.buildNode(n))}).join("\n"):"".concat(e.buildNode(n))}).join("\n")+"\n"+n.filter(function(n){return n.editable}).map(function(n){return"click ".concat(n.id," mermaidClick")}).join("\n")+"\n"+n.filter(function(n){return n.url}).map(function(n){return"click ".concat(n.id,' "').concat(n.url,'"')}).join("\n")+"\n"},buildNode:function(n){var e=n.edgeType?this.edges.find(function(e){return e.type===n.edgeType}):this.edges.find(function(n){return"default"===n.type});return"".concat(n.id).concat(e.open).concat(n.text).concat(e.close)},buildLink:function(n,e){return n.link?Array.isArray(n.link)?n.link.length>e?n.link[e]:n.link[n.link.length-1]:n.link:"--\x3e"},loadNodes:function(){this.load(this.parseCode)},init:function(){var n=this;window.mermaidClick=function(e){n.edit(e)},mermaid.initialize(Object.assign(this.defaultConfig,this.config))},load:function(n){if(n){var e=document.getElementById("mermaid");if(e){e.removeAttribute("data-processed"),e.replaceChild(document.createTextNode(n),e.firstChild);try{mermaid.init(n,e)}catch(n){if(this.stopOnError)throw n}}}},edit:function(n){this.$emit("nodeClick",n)}}};const __vue_script__=script;var __vue_render__=function(){var n=this,e=n.$createElement;return(n._self._c||e)("div",{staticClass:"mermaid",attrs:{id:"mermaid"}},[n._v(n._s(n.parseCode))])},__vue_staticRenderFns__=[];__vue_render__._withStripped=!0;const __vue_inject_styles__=function(n){n&&n("data-v-34a8bdc7_0",{source:"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",map:{version:3,sources:[],names:[],mappings:"",file:"vue-mermaid.vue"},media:void 0})},__vue_scope_id__=void 0,__vue_module_identifier__=void 0,__vue_is_functional_template__=!1;var VueMermaid=__vue_normalize__({render:__vue_render__,staticRenderFns:__vue_staticRenderFns__},__vue_inject_styles__,__vue_script__,void 0,!1,void 0,__vue_create_injector__,void 0),index={install:install};export default index;
