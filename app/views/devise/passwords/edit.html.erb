<%
=begin

Lesli

Copyright (c) 2023, Lesli Technologies, S. A.

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program. If not, see http://www.gnu.org/licenses/.

Lesli · Ruby on Rails SaaS development platform.

Made with ♥ by https://www.lesli.tech
Building a better future, one line of code at a time.

@contact  hello@lesli.tech
@website  https://www.lesli.tech
@license  GPLv3 http://www.gnu.org/licenses/gpl-3.0.en.html

// · ~·~     ~·~     ~·~     ~·~     ~·~     ~·~     ~·~     ~·~     ~·~
// · 
=end
%>


<% custom_app_page_path = "#{ lesli_instance_code }/lesli/devise/passwords/edit" %>
<% custom_app_page_exists = lookup_context.exists?(custom_app_page_path) %>



<%# render custom view in builder module %>
<% if custom_app_page_exists %>
<main id="lesli-application">
    <%= render :template => custom_app_page_path %>
</main>
<% end %>



<%# core view for passses %>
<% unless custom_app_page_exists %>
<main id="lesli-application">
    <section class="hero is-fullheight">
        <div class="hero-head">
            <div class="form-title has-text-centered">
                <%= image_tag "#{ lesli_instance_code }/brand/app-logo.svg", :alt => "logo", :class => "app-logo" %>
                <h2 class="is-size-2">Cambiar contraseña</h2>
            </div>
        </div>
        <div class="hero-body">
            <form ref="form" @submit="putPasswordEdit">
                <p v-if="notification.show" :class="[notification.type, 'is-size-5', 'mt-2']">
                    {{ notification.message }}
                </p>
                <div class="field mb-4">
                    <p class="label mb-2">Ingrese su nueva contraseña</p>
                    <p class="control has-icons-left">  
                        <input 
                            class="input" 
                            type="password"
                            v-model="password_edit.new_password"
                            required="true"
                            name="user_email"
                            placeholder="Contraseña nueva"
                        />
                        <span class="icon is-small is-left">
                            <span class="material-icons">
                                lock
                            </span>
                        </span>
                    </p>
                </div>
                <div class="field mb-4">
                    <p class="label mb-1">Confirmar contraseña</p>
                    <p class="control has-icons-left">  
                        <input 
                            class="input" 
                            type="password"
                            v-model="password_edit.new_password_confirmation"
                            required="true"
                            name="user_email"
                            placeholder="Confirmar contraseña"
                        />
                        <span class="icon is-small is-left">
                            <span class="material-icons">
                                lock
                            </span>
                        </span>
                    </p>
                </div>
                <div class="login-controls has-text-centered">
                    <button class="button is-primary">
                        Cambiar contraseña
                    </button>
                </div>
            </form>
            <div class="links">
                <p class="has-text-centered">
                    <%= link_to "Request a pass", pass_path %>
                </p>
                <p class="has-text-centered">
                    <%= link_to "Login", new_user_session_path %>
                </p>
            </div>
        </div>
    </section>
</main>
<% end %>
